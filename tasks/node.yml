---
# - name: nvm
#   shell: >
#     curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash
#   args:
#     creates: "{{ ansible_env.HOME }}/.nvm/nvm.sh"

- name: source zshrc profiles
  shell: source ~/.zshrc
  args:
    executable: /bin/bash

- name: Install default node version.
  shell: >
    . {{ ansible_env.HOME }}/.nvm/nvm.sh && nvm install {{ node_default_version }}
  args:
    executable: /bin/bash
    chdir: "{{ ansible_env.HOME }}"
    creates: "{{ ansible_env.HOME }}/.nvm/versions/node/v{{ node_default_version }}"

- name: Make Node {{ node_default_version }} as default.
  shell: >
    . {{ ansible_env.HOME }}/.nvm/nvm.sh && nvm alias default {{ node_default_version }}
  changed_when: false
# - name: Install global NPM packages.
#   npm:
#     name: "{{ item.name | default(item) }}"
#     state: "{{ item.state | default('present') }}"
#     version: "{{ item.version | default(omit) }}"
#     global: yes
#     executable: ". {{ ansible_env.HOME }}/.nvm/nvm.sh && {{ ansible_env.HOME }}/.nvm/versions/node/v{{ node_default_version }}/bin/npm"
#   with_items: "{{ npm_packages }}"
