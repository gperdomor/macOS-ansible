---
language: objective-c

sudo: required

os: osx

env:
  - TAGS=prep       SKIP_TAGS=no_ci,mas,mas_app,xcode,swiftlint
  - TAGS=stage_1    SKIP_TAGS=no_ci,mas,mas_app,xcode,swiftlint
  - TAGS=stage_2    SKIP_TAGS=no_ci,mas,mas_app,xcode,swiftlint
  - TAGS=stage_3    SKIP_TAGS=no_ci,mas,mas_app,xcode,swiftlint
  - TAGS=stage_4    SKIP_TAGS=no_ci,mas,mas_app,xcode,swiftlint

matrix:
  include:
    # macOS 10.12
    - osx_image: xcode8.2
    # macOS 10.11
    - osx_image: xcode8
  fast_finish: true

install:
  - pip install pexpect
  # Debug info
  - python --version
  # Run setup script
  - bash init.sh
  # Debug info
  - pip --version
  - ansible --version

script:
  # Playbook syntax check
  - ansible-playbook mac.yml --syntax-check
  # Run Ansible playbook:
  # - Skip tasks/roles that we know cause issues in Travis
  - ansible-playbook mac.yml --tags "$TAGS" --skip-tags "$SKIP_TAGS"